{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Certificate Format",
    "description": "This schema defines the format for certificates used in secure boot.",
    "type": "object",
    "properties": {
        "type": {
            "type": "string",
            "description": "Type of the certificate.",
            "enum": ["X.509", "TBS"]
        },
        "commonName": {
            "type": "string",
            "description": "The common name of the certificate."
        },
        "issuer": {
            "type": "string",
            "description": "The issuer of the certificate."
        },
        "path": {
            "type": "string",
            "description": "The file path to the certificate."
        },
        "sha256": {
            "type": "string",
            "pattern": "^[a-fA-F0-9]{64}$",
            "description": "The SHA-256 hash of the certificate in hexadecimal format."
        },
        "base64": {
            "type": "string",
            "pattern": "^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$",
            "description": "The Base64-encoded representation of the certificate or TBS (To Be Signed) data."
        },
        "comment": {
            "type": "string",
            "description": "Comment associated with the certificate."
        }
    },
    "required": ["path"],
    "oneOf": [
        { "required": ["sha256"] },
        { "required": ["base64"] }
    ],
    "additionalProperties": false
}